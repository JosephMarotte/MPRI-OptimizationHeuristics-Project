import pathlib
import pandas as pd
import matplotlib.pyplot as plt
from math import log


# Assume all data saved in a same file
def clean_data_random_local_search(filename, savepath="RLS_CLEANED.csv"):
    column_names = ["array_size", "nb_color", "nb_call"]

    percentile = [.02, .25, .50, .75, .98]
    data = pd.read_csv(filename, names=column_names, header=None, sep=" ")
    data2 = data.groupby(['array_size', 'nb_color'])

    data = data2.agg({'nb_call': [lambda x: x.quantile(0.02),
                                  lambda x: x.quantile(0.25),
                                  lambda x: x.quantile(0.50),
                                  lambda x: x.quantile(0.75),
                                  lambda x: x.quantile(0.98),
                                  'mean',
                                  'std',
                                  'count']})

    data.columns = list(map(''.join, data.columns.values))
    data.columns = ["per 0.02", "per 0.25", "per 0.5", "per 0.75", "per 0.98", "mean", "std dev", "count"]
    data = data.reset_index()
    data.to_csv(savepath)
    return data


def plot_data(data):
    plt.figure()
    plt.plot(data['array_size'], data['mean'], label="RLS")
    plt.plot(data['array_size'], [x * x * log(x, 2) for x in data['array_size']], label="x*x*log(x, 2))")
    plt.legend()
    plt.show()
    # can save where we want


def example():
    path_to_result_dir = str(pathlib.Path(__file__).parent.parent.absolute()) + "/results/" + "RLS_UNIFORM_MUTATION"
    data = clean_data_random_local_search(path_to_result_dir)
    plot_data(data)


example()
